<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Topological time series analysis</title>

		<meta name="description" content="Presentation on TDA applied to the study of time series">
		<meta name="author" content="Ximena Fernandez">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="../dist/reveal.css">
		<link rel="stylesheet" href="../dist/theme/white.css" id="theme">

		<meta name="viewport" content="width=device-width, initial-scale=1">
		<style>
			* {
			  box-sizing: border-box;
			}

			.column {
			  float: left;
			  width: 25%;
			  padding: 10px;
			}

			.column_big {
			  float: left;
			  width: 50%;
			  padding: 10px;
			}

			.column_Big {
			  float: left;
			  width: 75%;
			  padding: 10px;
			}	

			.column_eq {
			  float: left;
			  width: 33%;
			  padding: 10px;
			}	
			}

			/* Clear floats after the columns */
			.row:after {
			  content: "";
			  display: table;
			  clear: both;
			}
			</style>

	</head>

	<body>

		<div class="reveal">

			<div class="slides">


				<section>
					<h3>Topological data analysis & applications in dynamics </h3>
					<p style="font-size:30px;">XIMENA FERNANDEZ</p>
					<p style="font-size:24px;">UK Centre for Topological Data Analysis</p>
					<p style="font-size:22px;">Durham University</p>  
					<p style="font-size:34px;">BIOMAT 2022 </p> 
					
					<img src='media_ts/birdsongs.gif' width="1000" height=auto/>
				</section>
				

				<section>

					<section>
						<h2>Applications in dynamics</h2>

					</section>

					<section>
						<h2>Topology of time series</h2>
						<br>
						<p style="font-size: 18px;text-align:left;">$\bullet$ Perea, J.A., Harer, J. <i>Sliding Windows and Persistence: An Application of Topological Methods to Signal Analysis.</i> Found Comput Math 15, 799‚Äì838 (2015).</p>
						<p style="font-size: 18px;text-align:left;">$\bullet$ Perea J.A., <i>Topological Time Series Analysis</i>, Notices of the American Mathematical Society, vol. 66, no. 5, pp. 686-694, May 2019.</p>
					</section>

					<section data-auto-animate>
						<h3>Dynamical systems</h3>
						<br>
						<span style="font-size: 24px; text-align:left;">
						<ul>
							<li class="fragment">
								A <b>global continuous time dynamical system</b>
								is a pair $$(\mathcal{M}, \phi)$$ where $\mathcal{M}$ is a topological space and $\phi \colon \mathbb{R} \times \mathcal{M} \to \mathcal{M}$ is a continuous map such that $\phi(0, p) = p$ and $\phi(s, \phi(ùë°, ùëù)) = \phi(s + t, p)$ for all $p \in \mathcal{M}$ and all $t, s \in \mathbb{R}$.
							</li>
							<br>
							<li class="fragment">
								The typical examples arising from <b>differential equations</b> have as state space a smooth manifold $\mathcal{M}$ and the dynamics are given by the integral curves of a smooth vector field on $\mathcal{M}$.
							</li>
							<br>
							<li class="fragment">
								A set $A \subset \mathcal{M}$ is called an <b>attractor</b> if it satisfies the following conditions: it
								is compact, it is an invariant set (i.e. if $a \in A$
								then $\phi(ùë°, ùëé) \in ùê¥$ for all $ùë° \geq 0$) and it has an open
								basin of attraction.
								Equivalently, there is an invariant
								open neighborhood $ùëà \subset \mathcal{M}$ of $ùê¥$ such that
								$\cap_{t\geq 0} \{\phi(ùë°, ùëù) ‚à∂ ùëù \in ùëà\} = ùê¥$.
							</li>
						</ul>
						</span>
					</section>

						<section data-auto-animate>
						<h3>Dynamical systems</h3>
						<br>
						<span style="font-size: 24px; text-align:left;">
						<ul>
							<li>
								A <b>global continuous time dynamical system</b>
								is a pair $$(\mathcal{M}, \phi)$$ where $\mathcal{M}$ is a topological space and $\phi \colon \mathbb{R} \times \mathcal{M} \to \mathcal{M}$ is a continuous map such that $\phi(0, p) = p$ and $\phi(s, \phi(ùë°, ùëù)) = \phi(s + t, p)$ for all $p \in \mathcal{M}$ and all $t, s \in \mathbb{R}$.
							</li>
							<br>
							<li>
								The typical examples arising from <b>differential equations</b> have as state space a smooth manifold $\mathcal{M}$ and the dynamics are given by the integral curves of a smooth vector field on $\mathcal{M}$.
							</li>
						<div class="row" style="font-size: 18px">
					 	 		<div class="column_big" style="font-size: 18px">
					 	 		<br>
					 	 		<br>
					 	 		<b>Lorenz attractor</b>
								\begin{equation}\begin{cases}
								\dot x = \sigma ( y - x ) , \\
								\dot y = x(\rho-z)-y ,\\
								\dot z = xy-\beta z \end{cases}
								\end{equation}
								with $(\sigma, \rho, \beta) = (10, 28, 8/3)$. 
								</div>
								<div class="column_big">
								<img width="350" height = auto src='media_ts/lorenz_time_series.gif'/>
								</div>
						</div>

							
						</ul>
						</span>

					</section>

					<section data-auto-animate>
						<h3>Dynamical systems</h3>
						<span style="font-size: 24px; text-align:left;">
						<br>
						<li> In practice, we only have measurements, that are the result of an  <b>observation function</b> $F:\mathcal{M}\to \mathbb R$  and an <b>initial state</b> $p\in \mathcal{M}$ that produces a <b>time series</b>
							\begin{align}\varphi_p:\mathbb{R}&\to \mathbb{R}\\
							t&\mapsto F(\phi(t,p))
							\end{align}
						</li>
						<blockquote class="fragment" style="border: 2px solid #666; padding: 15px; background-color: #ccc; width:750px"> <b>Theorem (Takens).</b> Let $\mathcal{M}$ be a smooth, compact, Riemannian manifold. Let $\tau > 0$ be a real number and let $d ‚â• 2 \mathrm{dim}(\mathcal{M})$
						be an integer. Then, for generic $\phi \in  C^2(\mathbb{R} \times \mathcal{M}, \mathcal{M})$ and $F\in  C^2(\mathcal{M}, \mathbb{R})$ and for $\varphi_\bullet(ùë°)$ defined as above, the <b>delay map</b>
						\begin{align}
						\varphi~ \colon & ~~\mathcal{M} &\rightarrow & ~~\mathbb{R}^{d+1}\\
						&~~p &\mapsto & ~~(\varphi_p(0), \varphi_p(ùúè), \varphi_p(2ùúè),\dots, \varphi_p(d\tau))
						\end{align}
						is an embedding (i.e., $\varphi$ is injective and its derivative has full-rank everywhere).
						</blockquote>
					</span>
					</section>

					<section data-auto-animate>
						<h3>Dynamical systems</h3>
						<br>
						<span style="font-size: 24px; text-align:left;">
						<li> Let $f\colon\mathbb{R} \rightarrow \mathbb{R}$ be a function, $\tau> 0$ a real number and $d > 0$ an integer. The <b>sliding window embedding</b> (or <b>delay-embedding</b>) of $f$ with parameters $d$ and $\tau$ is the vector-valued function 
						\begin{align}
						SW_{d,\tau}f\colon &~~\mathbb{R}\rightarrow ~~\mathbb{R}^{d+1}\\
						&~~~t ~\mapsto ~(f(t), ùëì(t + \tau), ùëì(t + 2\tau), \dots, ùëì(t + d\tau))\\
						\end{align}
						</li>
						<li class="fragment"> Given time series data $f(t) = \varphi_p(t)$ with $t\in T$ observed
						from a potentially unknown dynamical system $(\mathcal{M}, \phi)$, Takens‚Äô theorem implies that (generically) the sliding window point cloud $SW_{d,\tau}f(T)$ provides a topological copy of $\{\phi(t, p) ‚à∂ t \in T\} \subseteq \mathcal{M}$. In particular this will reconstruct attractors. 
						</li>
						</span>
						<div  class="fragment" class="row" style="font-size: 18px">
							<div class="column_big">
							<img width="300" height = auto src='media_ts/lorenz_time_series.gif'/>
							</div>
				 	 		<div class="column_big" style="font-size: 18px">
				 	 		<img width="300" height = auto src='media_ts/lorenz_takens.gif'/>
							</div>
						</div>
					
					</section>


					<section data-auto-animate>
						<h3>Topology of time series</h3> 
						<h5>Periodicity</h5>
						<img width="800" height = auto src='media_ts/perea.png'/>
						</span>

						<p style="font-size: 15px">$\bullet$ Perea, J.A., Harer, J. <i>Sliding Windows and Persistence: An Application of Topological Methods to Signal Analysis.</i> Found Comput Math 15, 799‚Äì838 (2015).</p>
					</section>

				</section>

				<section>
					<section>
						<h2>Applications in real data</h2>
						<br>
						<br>
						<p style="font-size: 18px;text-align:left;">$\bullet$ Fernandez X., Borghini E., Mindlin G., Groisman P. <i>Intrinsic persistent homology via density-based metric learning</i>, 2020. arXiv:2012.07621</p>
						<p style="font-size: 18px; text-align:left;">$\bullet$ Fernandez X., Mateos D. <i>Topological prediction of epilepsy seizures.</i> Work in progress, 2021.</p>
					</section>


					<section data-auto-animate>
						<h3>Anomaly detection</h3>
						<h5 class="fragment">Electrocardiogram</h5>
						<img class="fragment" width="900" height = auto src='media_ts/ECG_signal_raw.png'/>
						<p class="fragment" style="font-size: 15px; text-align:left;"><i>Source data:</i> PhysioNet Database  https://physionet.org/about/database/</p>
					</section>

					<section data-auto-animate>
						<h3>Anomaly detection</h3>
						<h5>Electrocardiogram</h5>
						<img width="900" height = auto src='media_ts/ECG_signal_raw.png'/>
						<img width="300" height = auto src='media_ts/ECG_embedding_raw.png'/>
					</section>

					<section data-auto-animate>
						<h3>Anomaly detection</h3>
						<h5>Electrocardiogram</h5>
						<img width="900" height = auto src='media_ts/ECG_signal.png'/>
						<img width="300" height = auto src='media_ts/ECG_embedding.png'/>
					</section>

					<section data-auto-animate>
						<h3>Anomaly detection</h3>
						<h5>Electrocardiogram</h5>
						<img width="900" height = auto src='media_ts/ECG_signal.png'/>
						<div class="row">
						 	 <div class="column_eq">
							<img width="300" height = auto src='media_ts/ECG_embedding.png'/>
							</div>
							<div class="column_eq">
							<img width="290" height = auto src='media_ts/PH_ECG_4000.png'/>
							</div>
							<div class="fragment" class="column_eq">
							<img width="280" height = auto src='media_ts/PH_ECG_6000.png'/>
							</div>
						</div>
					</section>

					<section data-auto-animate>
						<h3>Anomaly detection</h3>
						<h5>Electrocardiogram</h5>
						<img width="900" height = auto src='media_ts/ECG_signal.png'/>
						<small>
						\[t\mapsto \mathbb{dgm_1}(SW_{\tau, d}f([0,t]))\]
						</small>
						<img width="900" height = auto src='media_ts/bottleneck_ECG.png'/>
					</section>


					<section data-auto-animate>
						<h3>Change-points detection</h3>
						<h4 class="fragment"> Birdsongs</h4>
						<img class="fragment" width="900" height = auto src='media_ts/birdsong.png'/>
						<p class="fragment" style="font-size: 15px; text-align:left;"><i>Source data:</i> Private experiments. Laboratory of Dynamical Systems, University of Buenos Aires.</p>
					</section>

					<section data-auto-animate>
						<h3>Change-points detection</h3>
						<h4> Birdsongs</h4>
						<img width="900" height = auto src='media_ts/birdsong.png'/><img width="300" height = auto src='media_ts/canary_embedding.png'/>
					</section>

					<section data-auto-animate>
						<h3>Change-points detection</h3>
						<h4> Birdsongs</h4>
						<img width="900" height = auto src='media_ts/birdsong.png'/>
						<div class="row">
						 	 <div class="column_big">
							<img width="300" height = auto src='media_ts/canary_embedding.png'/>
							</div>
							 <div class="column_big">
							 <img width="290" height = auto src='media_ts/PH_canary.png'/>
							 </div>
						</div>
					</section>

					<section data-auto-animate>
						<h3>Change-points detection</h3>
						<h4> Birdsongs</h4>
						<img width="900" height = auto src='media_ts/time_series_birdsong_cuts.png'/>
						<div class="row">
						 	 <div class="column_Big">
							<img width="800" height = auto src='media_ts/canary_embedding_cuts.png'/>
							</div>
							 <div class="column">
							 <img width="300" height = auto src='media_ts/PH_canary.png'/>
							 </div>
						</div>
					</section>

					<section data-auto-animate>
						<h3>Change-points detection</h3>
						<h4> Birdsongs</h4>
						<img width="900" height = auto src='media_ts/time_series_birdsong_cuts.png'/>
						<small>
						\[t\mapsto \mathbb{dgm_1}(SW_{\tau, d}f([0,t]))\]
						</small>

						<img width="900" height = auto src='media_ts/PH_canary_peaks.png'/>
					</section>


					<section data-auto-animate>
						<h4>Prediction of transitions</h4>
						<h5 class="fragment">Electroencefalogram</h5>
						<img class="fragment" width="650" height = auto src='media_ts/EEG.png'/>
						<p style="font-size: 15px; text-align:left;"><i>Source data:</i> Private experiments. Institute of Applied Math of Litoral (IMAL-CONICET-UNL).</p>
					</section>

					<section data-auto-animate>
						<h4>Prediction of transitions</h4>
						<h5 >Electroencefalogram</h5>
						<img width="810" height = auto src='media_ts/EEG_channel143.png'/>
						<small>
						\[t\mapsto \mathbb{dgm_0}((f_0, \dots, f_{143})[30000,t])\]
						</small>
						<br>
						<img  width="750" height = auto src='media_ts/Wasserstein_EEG.png'/>
						<p style="font-size: 15px; text-align:left;"><i>Source data:</i> Private experiments. Institute of Applied Math of Litoral (IMAL-CONICET-UNL).</p>
					</section>




					<section data-auto-animate>
						<h4>Prediction of transitions</h4>
						<h5 >Electroencefalogram</h5>
						<img width="810" height = auto src='media_ts/EEG_channel143.png'/>
						<small>
						$W$ size of the restricted interval.
						\[t\mapsto \mathbb{dgm_1}((f_0, \dots, f_{143})[t-W,t])\]
						</small>
						<br>
						<img width="920" height = auto src='media_ts/SW_EEG_dgm1.png'/>
						<p style="font-size: 15px; text-align:left;"><i>Source data:</i> Private experiments. Institute of Applied Math of Litoral (IMAL-CONICET-UNL).</p>
					</section>




				<section>
					<h2>Thanks!</h2>
					<img width="1000" height = auto src='media_ts/birdsong_twitter.gif'/>
				</section>


			</div>

		</div>

		<script src="../dist/reveal.js"></script>
		<script src="../plugin/math/math.js"></script>
		<script>
			Reveal.initialize({
				history: true,
				transition: 'linear',

				math: {
					// mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
					config: 'TeX-AMS_HTML-full',
					TeX: {
						Macros: {
							R: '\\mathbb{R}',
							set: [ '\\left\\{#1 \\; ; \\; #2\\right\\}', 2 ]
						}
					}
				},

				plugins: [ RevealMath ]
			});
		</script>

	</body>
</html>
